javascript:(function()%7B(function%20()%20%7B%0A%20%20%2F%2Fhttps%3A%2F%2Fkatanya.co.uk%2Flabs%2Fbookmarklet-generator%0A%0A%20%20var%20results%20%3D%20%5B%5D%3B%0A%0A%20%20function%20download(filename%2C%20text)%20%7B%0A%20%20%20%20var%20element%20%3D%20document.createElement('a')%3B%0A%20%20%20%20element.setAttribute('href'%2C%20'data%3Atext%2Fcsv%3Bcharset%3Dutf-8%2C%5CuFEFF'%20%2B%20encodeURIComponent(text))%3B%0A%20%20%20%20element.setAttribute('download'%2C%20filename)%3B%0A%0A%20%20%20%20element.style.display%20%3D%20'none'%3B%0A%20%20%20%20document.body.appendChild(element)%3B%0A%0A%20%20%20%20element.click()%3B%0A%0A%20%20%20%20document.body.removeChild(element)%3B%0A%20%20%7D%0A%0A%20%20const%20headlines%20%3D%20%5B%5D%3B%0A%0A%20%20%5B...document.querySelectorAll('main%3Ec-wiz%3Ediv%3Ediv')%5D.forEach(el%20%3D%3E%20%7B%0A%20%20%20%20var%20btn%20%3D%20document.createElement('div')%3B%0A%20%20%20%20btn.className%20%3D%20'voting'%0A%20%20%20%20btn.innerHTML%20%3D%20'%3Cdiv%20class%3D%22vote%20positive%22%3E%F0%9F%91%8D%3C%2Fdiv%3E%3Cdiv%20class%3D%22vote%20negative%22%3E%F0%9F%91%8E%3C%2Fdiv%3E'%3B%0A%0A%20%20%20%20var%20h3%20%3D%20el.querySelector('h3')%3B%0A%0A%20%20%20%20if%20(!h3)%20%7B%0A%20%20%20%20%20%20return%0A%20%20%20%20%7D%0A%20%20%20%20var%20time%20%3D%20el.querySelector('time')%3B%0A%0A%20%20%20%20var%20headline%20%3D%20h3.textContent%3B%0A%20%20%20%20var%20dateTime%20%3D%20time.attributes.dateTime.value%3B%0A%20%20%20%20var%20source%20%3D%20time.previousSibling.textContent%3B%0A%0A%20%20%20%20btn.onclick%20%3D%20(e)%20%3D%3E%20%7B%0A%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20e.stopPropagation()%3B%0A%0A%20%20%20%20%20%20var%20positive%20%3D%20e.target.classList.contains('positive')%3B%0A%0A%20%20%20%20%20%20vote(headline%2C%20positive%2C%20dateTime%2C%20source)%3B%0A%20%20%20%20%20%20activate(positive)%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20function%20activate(positive)%20%7B%0A%20%20%20%20%20%20var%20positiveBtn%20%3D%20btn.querySelector('.positive')%3B%0A%20%20%20%20%20%20var%20negativeBtn%20%3D%20btn.querySelector('.negative')%3B%0A%0A%20%20%20%20%20%20if%20(positive)%20%7B%0A%20%20%20%20%20%20%20%20positiveBtn.classList.add('active')%3B%0A%20%20%20%20%20%20%20%20negativeBtn.classList.remove('active')%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20negativeBtn.classList.add('active')%3B%0A%20%20%20%20%20%20%20%20positiveBtn.classList.remove('active')%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20if%20(h3)%20%7B%0A%20%20%20%20el.appendChild(btn)%3B%0A%20%20%20%20headlines.push(%7B%20headline%2C%20dateTime%2C%20source%20%7D)%3B%0A%20%20%20%20%2F%2F%20h3.style.background%20%3D%20'red'%0A%20%20%20%20%2F%2F%20%7D%0A%0A%20%20%7D)%0A%0A%20%20const%20vote%20%3D%20(headline%2C%20positive%2C%20datetime%2C%20source)%20%3D%3E%20%7B%0A%20%20%20%20results%20%3D%20%5B...results.filter(r%20%3D%3E%20r.headline%20!%3D%3D%20headline)%2C%20%7B%20headline%2C%20positive%2C%20datetime%2C%20source%20%7D%5D%0A%20%20%20%20displayResults()%3B%0A%20%20%7D%0A%0A%20%20const%20displayResults%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20var%20total%20%3D%20results.length%3B%0A%20%20%20%20var%20pos%20%3D%20results.filter(r%20%3D%3E%20r.positive).length%3B%0A%20%20%20%20var%20neg%20%3D%20results.filter(r%20%3D%3E%20!r.positive).length%3B%0A%0A%20%20%20%20document.querySelector('.results-button').textContent%20%3D%20%60Get%20results%20(%F0%9F%91%8D%24%7Bpos%7D%20%F0%9F%91%8E%24%7Bneg%7D%20%CE%A3%24%7Btotal%7D%20)%60%3B%0A%20%20%7D%0A%0A%20%20const%20style%20%3D%20document.createElement('style')%3B%0A%20%20style.innerHTML%20%3D%20%60%0A%20%20%20%20%20%20.voting%20%7B%0A%20%20%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.vote%20%7B%0A%20%20%20%20%20%20height%3A%2035px%3B%0A%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20width%3A%2049px%3B%0A%20%20%20%20%20%20position%3A%20relative%3B%0A%20%20%20%20%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20%20%20%20%20color%3A%20white%3B%0A%20%20%20%20%20%20border%3A%201px%20solid%20%235f6368%3B%0A%20%20%20%20%20%20text-align%3A%20center%3B%0A%20%20%20%20%20%20font-size%3A%2020px%3B%0A%20%20%20%20%20%20bottom%3A%200%3B%0A%20%20%20%20%20%20border-radius%3A%205px%3B%0A%20%20%20%20%20%20z-index%3A%209999%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20.vote.positive.active%7B%0A%20%20%20%20%20%20%20%20background%3A%20%231b901b%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20.vote.negative.active%7B%0A%20%20%20%20%20%20%20%20background%3A%20%23ffa500%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20.vote%3Ahover%20%7B%0A%20%20%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20%20%20background%3A%20%23FFF%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20.results-button%7B%0A%20%20%20%20%20%20%20%20position%3A%20fixed%3B%0A%20%20%20%20%20%20%20%20bottom%3A%200%3B%0A%20%20%20%20%20%20%20%20right%3A%200%3B%0A%20%20%20%20%20%20%20%20z-index%3A%209999%3B%0A%20%20%20%20%20%20%20%20height%3A%2040px%3B%0A%20%20%20%20%20%20%20%20width%3A%20200px%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20.save-for-later%7B%0A%20%20%20%20%20%20%20%20bottom%3A%2040px%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%60%3B%0A%20%20document.head.appendChild(style)%3B%0A%0A%20%20var%20btn%20%3D%20document.createElement('button')%0A%20%20btn.className%20%3D%20'results-button'%3B%0A%20%20btn.innerHTML%20%3D%20'Get%20results'%3B%0A%0A%20%20btn.onclick%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20var%20resultArray%20%3D%20%5B%5B'Date'%2C%20'Headline'%2C%20'Pos%2FNeg'%2C%20'Source'%5D%2C%0A%20%20%20%20...results.map(r%20%3D%3E%20%5B%0A%20%20%20%20%20%20wrapWithQuotes(h.dateTime)%2C%0A%20%20%20%20%20%20wrapWithQuotes(h.headline)%2C%0A%20%20%20%20%20%20wrapWithQuotes(r.positive%20%3F%20'%2B'%20%3A%20'-')%2C%0A%20%20%20%20%20%20wrapWithQuotes(h.source)%5D)%5D%0A%0A%20%20%20%20let%20csvContent%20%3D%20toCsv(resultArray)%0A%0A%20%20%20%20var%20currentDate%20%3D%20getCurrentDateString()%3B%0A%20%20%20%20var%20country%20%3D%20getCountry()%3B%0A%0A%20%20%20%20var%20pos%20%3D%20results.filter(r%20%3D%3E%20r.positive).length%3B%0A%20%20%20%20var%20neg%20%3D%20results.filter(r%20%3D%3E%20!r.positive).length%3B%0A%0A%20%20%20%20download(%60%24%7Bcountry%7Dp%24%7Bpos%7Dn%24%7Bneg%7D_%24%7BcurrentDate%7D.csv%60%2C%20csvContent)%0A%20%20%7D%0A%20%20document.body.appendChild(btn)%3B%0A%0A%20%20var%20saveForLater%20%3D%20document.createElement('button')%0A%20%20saveForLater.className%20%3D%20'results-button%20save-for-later'%3B%0A%20%20saveForLater.innerHTML%20%3D%20'Save%20for%20later'%3B%0A%0A%20%20saveForLater.onclick%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20var%20resultArray%20%3D%20%5B%5B'Date'%2C%20'Headline'%2C%20'Pos%2FNeg'%2C%20'Source'%5D%2C%0A%20%20%20%20...headlines.map(h%20%3D%3E%20%5B%0A%20%20%20%20%20%20wrapWithQuotes(h.dateTime)%2C%0A%20%20%20%20%20%20wrapWithQuotes(h.headline)%2C%0A%20%20%20%20%20%20wrapWithQuotes('')%2C%0A%20%20%20%20%20%20wrapWithQuotes(h.source)%5D)%5D%0A%0A%20%20%20%20let%20csvContent%20%3D%20toCsv(resultArray)%3B%0A%0A%20%20%20%20var%20currentDate%20%3D%20getCurrentDateString()%3B%0A%20%20%20%20var%20country%20%3D%20getCountry()%3B%0A%0A%20%20%20%20download(%60%24%7Bcountry%7D_%24%7BcurrentDate%7D.csv%60%2C%20csvContent)%0A%20%20%7D%0A%0A%20%20document.body.appendChild(saveForLater)%3B%0A%0A%20%20function%20toCsv(array)%20%7B%0A%20%20%20%20return%20array.map(e%20%3D%3E%20e.join(%22%2C%22)).join(%22%5Cn%22)%3B%0A%20%20%7D%0A%0A%20%20function%20getCountry()%20%7B%0A%20%20%20%20return%20Object.fromEntries(%5B...new%20URLSearchParams(location.search)%5D).gl%3B%0A%20%20%7D%0A%20%20function%20getCurrentDateString()%20%7B%0A%20%20%20%20return%20new%20Date().toUTCString(%22uk-UA%22).replaceAll('%2C'%2C%20'').replaceAll('%20'%2C%20'_')%3B%0A%20%20%7D%0A%0A%20%20function%20wrapWithQuotes(text)%20%7B%0A%20%20%20%20return%20%60%22%24%7Btext.replaceAll(%60%22%60%2C%20%60%22%22%60)%7D%22%60%0A%20%20%7D%0A%0A%7D)()%7D)()
